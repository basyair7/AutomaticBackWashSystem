#ifndef WEBSERVER_HPP
#define WEBSERVER_HPP

#include <Arduino.h>
#include <AsyncTCP.h>
#include <ESPAsyncWebServer.h>
#include <ESPmDNS.h>
#include <ArduinoJson.h>
#include "TypeSerial"

class WebServer {
public:
    WebServer(int _port) : server(_port) {}
    void begin();

private:
    void handleNotFound(AsyncWebServerRequest *req);
    void postData(AsyncWebServerRequest *req, uint8_t *data, size_t len, size_t index, size_t total);
    void sendData(AsyncWebServerRequest *req);
    void recovery(AsyncWebServerRequest *req);
    void updateRelayState(int relay, bool state);

private:
    AsyncWebServer server;
    const int relayPins[4] = {12, 14, 25, 26};
    const char* relayKeys[4] = {"relay1", "relay2", "relay3", "relay4"};
};

#endif