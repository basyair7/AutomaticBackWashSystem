#ifndef WEBSERVER_HPP
#define WEBSERVER_HPP

#include <Arduino.h>
#include <AsyncTCP.h>
#include <ESPAsyncWebServer.h>
#include <ESPmDNS.h>
#include <ArduinoJson.h>
#include "variable.h"
#include "TypeSerial"

class WebServer {
public:
    WebServer(int _port) : server(_port) {}
    void begin();

private:
    void handleNotFound(AsyncWebServerRequest *req);
    void recovery(AsyncWebServerRequest *req);
    void updateRelayState(int relay, bool state);

private:
    void postRelay(AsyncWebServerRequest *req, uint8_t *data, size_t len, size_t index, size_t total);
    void sendRelayStatus(AsyncWebServerRequest *req);
    void sendData(AsyncWebServerRequest *req);

private:
    AsyncWebServer server;
};

#endif